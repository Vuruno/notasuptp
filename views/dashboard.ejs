<h1> <br> </h1>

<h3 id="meetings"> Links of meetings (online classes)</h3>
<div class="row row-cols-auto">
    <% for( myClass of user.enrolled ) { %>
        <div class="col">
            <%= myClass.subject %>:
                <a target="_blank" href="<% for (x of allSubjects) { if(x._id == myClass.id) {
                    %> <%= x.meeting %> <% } } %>">
                    <% for (x of allSubjects) { if(x._id==myClass.id) { %>
                        <%= x.meeting %>
                            <% } } %>
                </a>
        </div>
        <% } %>
</div>

<br>
<hr>
<br>

<h3 id="classrooms"> Codes / Links of classrooms</h3>
<div class="row row-cols-auto">
    <% for( myClass of user.enrolled ) { %>
        <div class="col">
            <%= myClass.subject %>:
                <% for (x of allSubjects) { if(x._id==myClass.id) { %>
                    <%= x.classroom %>
                        <% } } %>
        </div>
        <% } %>
</div>

<br>
<hr>
<br>

<h3 id="schedule">
    Schedule</h3>
<a target="_black" class="btn btn-outline-warning"
    href="https://docs.google.com/spreadsheets/d/1IOxtOFOwBv--sO5FBnln-VibARcyjulR/edit?usp=sharing&ouid=113836366338657524799&rtpof=true&sd=true">
    Classes & Exams (g sheets)
</a>
<a target="_black" class="btn btn-outline-success"
    href="https://calendar.google.com/calendar/u/0?cid=cG5zMDNodm1jOHZqYXI2NTI1ZzM4aDMyamtAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ">
    Join to google calendar
</a>

<a target="_black" class="btn btn-outline-warning" href="#" hidden>
    Classes (.png)
</a>
<a target="_black" class="btn btn-outline-warning" href="#" hidden>
    Midterm (.png)
</a>
<a target="_black" class="btn btn-outline-warning" href="#" hidden>
    Final (.png)
</a>
<% var today=new Date() %>
    <% const weekday=[" Sunday" ," Monday" ," Tuesday" ," Wednesday" ," Thursday" ," Friday" ," Saturday" ] %>
        <div class="mt-3 row row-cols-auto row-cols-md-5">
            <% for (day of weekSchedule) { if(day[0] !=undefined) { %>
                <div class="col">
                    <% if (new Date(day[0].start.dateTime).getDate()==today.getDate()) { %>
                        <div class="card border-primary mb-3">
                            <div class="card-header">
                                Today
                                <% } else { %>
                                    <div class="card bg-dark mb-3">
                                        <div class="card-header">
                                            <%= weekday[new Date(day[0].start.dateTime).getDay()] %>
                                                <% } %>
                                                    <div class="text-muted">
                                                        <%= new Date(day[0].start.dateTime).getDate() %>
                                                            /
                                                            <%= new Date(day[0].start.dateTime).getMonth() %>
                                                                /
                                                                <%= new Date(day[0].start.dateTime).getFullYear() %>
                                                    </div>
                                        </div>


                                        <div class="card-body py-0">
                                            <p class="card-text">
                                                <% for (x of day) { %>
                                                    <% if (x.start.dateTime !=undefined ) { %>
                                                        <div class="text-muted d-inline ">
                                                            <%= new Date(x.start.dateTime).getHours() %>:
                                                                <% if (new Date(x.start.dateTime).getMinutes() < 10) {%>
                                                                    0<%= new Date(x.start.dateTime).getMinutes() %>
                                                                        <% } else {%>
                                                                            <%= new Date(x.start.dateTime).getMinutes()
                                                                                %>
                                                                                <% } %>
                                                                                    -
                                                                                    <%= new
                                                                                        Date(x.end.dateTime).getHours()
                                                                                        %>:
                                                                                        <% if (new
                                                                                            Date(x.end.dateTime).getMinutes()
                                                                                            < 10) {%>
                                                                                            0<%= new
                                                                                                Date(x.end.dateTime).getMinutes()
                                                                                                %>
                                                                                                <% } else {%>
                                                                                                    <%= new
                                                                                                        Date(x.end.dateTime).getMinutes()
                                                                                                        %>
                                                                                                        <% } %>
                                                                                                            <% } else {
                                                                                                                %>
                                                                                                                All day
                                                                                                                <% } %>
                                                        </div>
                                                        <div class="d-inline">
                                                            <% let link='#shedule' ; for (subject of allSubjects) {
                                                                if(x.summary.toLowerCase().includes(subject.subject.toLowerCase()))
                                                                { link=subject.meeting }%>
                                                                <% } %>
                                                                    <a target="_blank"
                                                                        class="text-white text-decoration-none"
                                                                        href="<%=link%>">
                                                                        <%=x.summary%>
                                                                    </a>
                                                        </div>
                                                        <br>
                                                        <% } %>
                                            </p>
                                        </div>

                                        <div class="card-footer">
                                            Homeworks
                                            <% for (hw of allHw) { if(new Date(typeof day[0].start.dateTime
                                                !='undefined' ? day[0].start.dateTime : day[0].start.date).getDate() +
                                                new Date(typeof day[0].start.dateTime !='undefined' ?
                                                day[0].start.dateTime : day[0].start.date).getMonth() * 30==new
                                                Date(typeof hw.end.dateTime !='undefined' ? hw.end.dateTime :
                                                hw.end.date).getDate() + new Date(typeof hw.end.dateTime !='undefined' ?
                                                hw.end.dateTime : hw.end.date).getMonth() * 30) { %>
                                                <br>
                                                <div class="d-inline text-muted">
                                                    <% if (hw.end.dateTime !=undefined) { %>
                                                        <%= new Date(hw.end.dateTime).getHours()%>:<%= new
                                                                Date(hw.end.dateTime).getMinutes()%>
                                                                <% } else { %>
                                                                    23:59
                                                                    <% } %>

                                                </div>
                                                <div class="d-inline">
                                                    <% if(hw.description !=undefined && hw.description.split('http')[1]
                                                        !=undefined) { %>
                                                        <a class="text-white"
                                                            href="<%= 'http'+ hw.description.split('http')[1].split(' ')[0] %>">
                                                            <%=hw.summary.split(':')[0]%>
                                                        </a>
                                                        <% } else {%>
                                                            <%=hw.summary.split(':')[0]%>
                                                                <% } %>
                                                </div>
                                                <% }} %>
                                        </div>
                                    </div>
                            </div>
                            <% }} %>
                        </div>

                        <br>
                        <hr>
                        <br>

                        <h3 id="hws">
                            My homeworks
                        </h3>
                        <a target="_black" class="btn btn-outline-success"
                            href="https://calendar.google.com/calendar/u/0?cid=aWNlaGZtODJlbHJjMzFlNjEwcnQ3cTI1YnNAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ">
                            Join to google calendar
                        </a>
                        <div class="row row-cols-auto row-cols-md-4">
                            <% for (hw of allHw) { %>
                                <% let end=new Date(hw.end.dateTime) %>
                                    <div class="col">
                                        <div class="card bg-dark mb-3">
                                            <div class="card-header">
                                                <% if(hw.description !=undefined && hw.description.split('http')[1]
                                                    !=undefined) { %>
                                                    <a class="text-white btn btn-link py-0"
                                                        href="<%= 'http'+ hw.description.split('http')[1].split(' ')[0] %>">
                                                        <%=hw.summary%>
                                                    </a>
                                                    <% } else {%>
                                                        <%=hw.summary%>
                                                            <% } %>
                                                                <div class="text-muted">
                                                                    <% if (!isNaN(end.getDate())) { %>
                                                                        <%=end.getDate()%> /
                                                                            <%=end.getMonth()%> /
                                                                                <%=end.getFullYear()%> &nbsp
                                                                                    <%=end.getHours()%>:
                                                                                        <%=end.getMinutes()%>
                                                                                            <% } else { %>
                                                                                                <% end=new
                                                                                                    Date(hw.end.date) %>
                                                                                                    <%=end.getDate()%> /
                                                                                                        <%=end.getMonth()%>
                                                                                                            /
                                                                                                            <%=end.getFullYear()%>
                                                                                                                &nbsp
                                                                                                                23:59
                                                                                                                <% } %>
                                                                </div>
                                            </div>
                                            <% if(hw.description !=undefined) { %>
                                                <div class="card-body">
                                                    <p class="card-text">
                                                        <% for (x in hw.description.split('http')) { if (x !=1) {%>
                                                            <%= hw.description.split('http')[x] %>
                                                                <% }} %>
                                                    </p>
                                                </div>
                                                <% } %>
                                        </div>
                                    </div>
                                    <%}%>
                        </div>
                        <br>
                        <hr>
                        <br>
                        <h3 id="calendar">
                            Academic anual calendar
                        </h3>
                        <a target="_black" class="btn btn-outline-warning"
                            href="https://drive.google.com/file/d/1mxRZEOKx8ncabOxEsX6PeXW3nNYBTC-i/view?usp=sharing">
                            View / Download
                        </a>
                        <a target="_black" class="btn btn-outline-success"
                            href="https://calendar.google.com/calendar/u/0?cid=cG5zMDNodm1jOHZqYXI2NTI1ZzM4aDMyamtAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ">
                            Join to google calendar
                        </a>
                        <h1>
                            <br>
                        </h1>
                        <script src="./notifySub.js"></script>